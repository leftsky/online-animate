import{d as S,r as m,g as F,o as _,w as l,b as a,u as s,a as o,e as u,v as x,c as B,t as y,f as I}from"./app-Dynu5tc5.js";import{a as P,b as R,c as T,d as W,_ as j}from"./DialogTitle.vue_vue_type_script_setup_true_lang-Bnsa-2D0.js";import{_ as A}from"./DialogDescription.vue_vue_type_script_setup_true_lang-DtC2VvC9.js";import{_ as k}from"./Button.vue_vue_type_script_setup_true_lang-BgPnemTW.js";import{a as $,_ as E}from"./Label.vue_vue_type_script_setup_true_lang-BZ8aVwwL.js";import{U as J}from"./upload-Ba6rq5iT.js";import{L as K}from"./loader-circle-BVPnn1NH.js";const O={class:"space-y-4"},q={class:"space-y-2"},H={class:"space-y-2"},Q={key:0,class:"space-y-2"},X={class:"mx-auto w-12 h-12 bg-muted rounded-full flex items-center justify-center"},Y={key:1,class:"space-y-2"},Z=["src"],ee={class:"text-sm font-medium"},te={class:"text-xs text-muted-foreground"},me=S({__name:"CreateContentDialog",emits:["confirm"],setup(se,{expose:b,emit:D}){const f=m(!1),i=m(null),v=m(""),d=m(""),c=m(!1),p=m(),N=D,V=()=>{f.value=!0,g()},C=()=>{f.value=!1,g()},h=()=>{var t;(t=p.value)==null||t.click()},M=t=>{const e=t.target.files;e&&e.length>0&&w(e[0])},U=t=>{var n;t.preventDefault();const e=(n=t.dataTransfer)==null?void 0:n.files;if(e&&e.length>0){const r=e[0];r.type.startsWith("image/")&&w(r)}},w=t=>{i.value=t;const e=new FileReader;e.onload=n=>{var r;v.value=(r=n.target)==null?void 0:r.result},e.readAsDataURL(t)},g=()=>{i.value=null,v.value="",d.value="",p.value&&(p.value.value="")},L=t=>{if(t===0)return"0 Bytes";const e=1024,n=["Bytes","KB","MB","GB"],r=Math.floor(Math.log(t)/Math.log(e));return parseFloat((t/Math.pow(e,r)).toFixed(2))+" "+n[r]},z=()=>{C()},G=()=>{i.value&&d.value.trim()&&N("confirm",{file:i.value,elementName:d.value.trim()})};return b({open:V,close:C,setLoading:t=>{c.value=t}}),(t,e)=>(_(),F(s(j),{open:f.value,"onUpdate:open":e[3]||(e[3]=n=>f.value=n)},{default:l(()=>[a(s(P),{class:"sm:max-w-md"},{default:l(()=>[a(s(R),null,{default:l(()=>[a(s(T),null,{default:l(()=>e[4]||(e[4]=[u("添加分镜内容",-1)])),_:1,__:[4]}),a(s(A),null,{default:l(()=>e[5]||(e[5]=[u(" 选择一张图片来创建新的分镜内容 ",-1)])),_:1,__:[5]})]),_:1}),o("div",O,[o("div",q,[a(s($),null,{default:l(()=>e[6]||(e[6]=[u("内容名称",-1)])),_:1,__:[6]}),a(s(E),{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=n=>d.value=n),type:"text",placeholder:"请输入分镜内容名称"},null,8,["modelValue"])]),o("div",H,[a(s($),null,{default:l(()=>e[7]||(e[7]=[u("选择图片",-1)])),_:1,__:[7]}),o("div",{class:"border-2 border-dashed border-muted-foreground/25 rounded-lg p-8 text-center hover:bg-muted/50 transition-colors cursor-pointer",onClick:h,onDrop:U,onDragover:e[1]||(e[1]=x(()=>{},["prevent"])),onDragenter:e[2]||(e[2]=x(()=>{},["prevent"]))},[i.value?(_(),B("div",Y,[o("img",{src:v.value,alt:"预览",class:"mx-auto max-h-32 rounded"},null,8,Z),o("p",ee,y(i.value.name),1),o("p",te,y(L(i.value.size)),1),a(s(k),{variant:"outline",size:"sm",onClick:x(g,["stop"])},{default:l(()=>e[10]||(e[10]=[u(" 重新选择 ",-1)])),_:1,__:[10]})])):(_(),B("div",Q,[o("div",X,[a(s(J),{class:"w-6 h-6 text-muted-foreground"})]),e[8]||(e[8]=o("p",{class:"text-sm text-muted-foreground"}," 点击选择图片或拖拽到此处 ",-1)),e[9]||(e[9]=o("p",{class:"text-xs text-muted-foreground"}," 支持 JPG、PNG、GIF、WebP 格式 ",-1))]))],32)])]),a(s(W),null,{default:l(()=>[a(s(k),{variant:"outline",onClick:z},{default:l(()=>e[11]||(e[11]=[u("取消",-1)])),_:1,__:[11]}),a(s(k),{onClick:G,disabled:!i.value||!d.value.trim()||c.value},{default:l(()=>[c.value?(_(),F(s(K),{key:0,class:"w-4 h-4 mr-2 animate-spin"})):I("",!0),u(" "+y(c.value?"创建中...":"确认添加"),1)]),_:1},8,["disabled"])]),_:1}),o("input",{ref_key:"fileInput",ref:p,type:"file",class:"hidden",accept:"image/*",onChange:M},null,544)]),_:1})]),_:1},8,["open"]))}});export{me as _};
