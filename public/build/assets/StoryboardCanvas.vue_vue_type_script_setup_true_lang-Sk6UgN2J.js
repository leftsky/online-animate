import{I as C,A as k}from"./AnimationPlayer-CK-JCqiT.js";import{d as E,r as i,p as b,Q as P,q as S,c as x,o as z,a as v,b as B}from"./app-Dynu5tc5.js";const I={class:"absolute top-6 right-6"},q=E({__name:"StoryboardCanvas",emits:["animationStart","animationEnd","animationProgress"],setup(L,{expose:m,emit:d}){const t=i(),s=i(),a=i(null),e=i(),c=i(!1),l=d,u=()=>{if(!t.value)return{width:800,height:600};const n=t.value.getBoundingClientRect();return{width:n.width-32,height:n.height-32}},r=()=>{if(!a.value||!t.value)return;const{width:n,height:o}=u();a.value.setDimensions({width:n,height:o}),a.value.renderAll()};b(async()=>{if(await P(),s.value&&t.value){const{width:n,height:o}=u();a.value=new C(s.value,{width:n,height:o,backgroundColor:"#f8f9fa",selection:!1,interactive:!1}),window.addEventListener("resize",r)}}),S(()=>{a.value&&(a.value.dispose(),a.value=null),window.removeEventListener("resize",r)});const f=()=>{a.value&&(a.value.clear(),a.value.backgroundColor="#f8f9fa",a.value.renderAll())},h=async n=>{e.value&&(await e.value.setAnimation(n),e.value.playAnimation())},p=()=>{e.value&&e.value.stopAnimation()},A=()=>{e.value&&e.value.pauseAnimation()},g=()=>{e.value&&e.value.replayAnimation()},_=()=>{c.value=!0,l("animationStart")},w=()=>{c.value=!1,l("animationEnd")},y=n=>{l("animationProgress",n)};return m({clearCanvas:f,canvas:a,resizeCanvas:r,playAnimation:h,stopAnimation:p,pauseAnimation:A,replayAnimation:g}),(n,o)=>(z(),x("div",{ref_key:"canvasContainer",ref:t,class:"relative h-full w-full p-4"},[v("canvas",{ref_key:"canvasElement",ref:s,class:"block border rounded"},null,512),v("div",I,[B(k,{ref_key:"animationPlayer",ref:e,canvas:a.value,onAnimationStart:_,onAnimationEnd:w,onAnimationProgress:y},null,8,["canvas"])])],512))}});export{q as _};
