import{d as X,r as p,h,c as d,o as l,a as t,b as x,u,g as y,t as b,l as f,F as _,j as k,v as q}from"./app-Dynu5tc5.js";import{S as z,a as D}from"./skip-forward-CMt3hMhQ.js";import{P as I}from"./play-0jxsF_Wc.js";import{P as L,S as O}from"./square-BNppj9Dq.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./createLucideIcon-CZW-bvdG.js";const W={class:"flex h-full flex-col border-t bg-card"},A={class:"flex items-center justify-between border-b px-4 py-2"},G={class:"flex items-center space-x-2"},H=["title"],J={class:"flex items-center space-x-4"},Q={class:"text-sm font-mono text-muted-foreground"},U={class:"flex-1 overflow-x-auto"},Y={class:"relative h-8 border-b bg-muted/30"},Z={class:"mt-1 text-xs text-muted-foreground"},ee=["title","onClick"],te=X({__name:"Timeline",props:{duration:{default:10},selectedObject:{}},emits:["play","pause","stop","seek","addKeyframe","removeKeyframe"],setup(w,{emit:S}){const a=w,r=S,n=p(!1),i=p(0),v=p([]),g=p(800),C=h(()=>g.value/a.duration),P=()=>{n.value?M():T()},T=()=>{n.value=!0,r("play")},M=()=>{n.value=!1,r("pause")},B=()=>{n.value=!1,i.value=0,r("stop"),r("seek",0)},K=()=>{i.value=0,r("seek",0)},$=()=>{i.value=a.duration,r("seek",a.duration)},j=s=>{const o=s.currentTarget.getBoundingClientRect(),e=s.clientX-o.left,c=Math.max(0,Math.min(a.duration,e/C.value));i.value=c,r("seek",c)},F=s=>{const o=v.value.findIndex(e=>e.id===s);o>-1&&(v.value.splice(o,1),r("removeKeyframe",s))},m=s=>{const o=Math.floor(s/60),e=Math.floor(s%60),c=Math.floor(s%1*100);return`${o.toString().padStart(2,"0")}:${e.toString().padStart(2,"0")}.${c.toString().padStart(2,"0")}`},E=h(()=>{const s=[],o=a.duration<=10?1:a.duration<=60?5:10;for(let e=0;e<=a.duration;e+=o)s.push({time:e,position:e/a.duration*100,label:m(e)});return s}),N=h(()=>i.value/a.duration*100),V=s=>s/a.duration*100;return(s,o)=>(l(),d("div",W,[t("div",A,[t("div",G,[t("button",{onClick:K,class:"rounded-md p-1 text-muted-foreground hover:bg-accent hover:text-accent-foreground",title:"跳到开始"},[x(u(z),{class:"h-4 w-4"})]),t("button",{onClick:P,class:"rounded-md bg-primary p-2 text-primary-foreground hover:bg-primary/90",title:n.value?"暂停":"播放"},[n.value?(l(),y(u(L),{key:1,class:"h-4 w-4"})):(l(),y(u(I),{key:0,class:"h-4 w-4"}))],8,H),t("button",{onClick:B,class:"rounded-md p-1 text-muted-foreground hover:bg-accent hover:text-accent-foreground",title:"停止"},[x(u(O),{class:"h-4 w-4"})]),t("button",{onClick:$,class:"rounded-md p-1 text-muted-foreground hover:bg-accent hover:text-accent-foreground",title:"跳到结束"},[x(u(D),{class:"h-4 w-4"})])]),t("div",J,[t("span",Q,b(m(i.value))+" / "+b(m(s.duration)),1)])]),t("div",U,[t("div",{class:"relative h-full min-w-full",style:f({width:g.value+"px"})},[t("div",Y,[(l(!0),d(_,null,k(E.value,e=>(l(),d("div",{key:e.time,class:"absolute flex flex-col items-center",style:f({left:e.position+"%"})},[o[0]||(o[0]=t("div",{class:"h-2 w-px bg-border"},null,-1)),t("span",Z,b(e.label),1)],4))),128))]),t("div",{class:"relative h-20 cursor-pointer bg-muted/20",onClick:j},[(l(!0),d(_,null,k(v.value,e=>(l(),d("div",{key:e.id,class:"absolute top-2 h-4 w-4 cursor-pointer rounded-full bg-primary shadow-sm hover:bg-primary/90",style:f({left:V(e.time)+"%",transform:"translateX(-50%)"}),title:`关键帧 - ${m(e.time)}`,onClick:q(c=>F(e.id),["stop"])},o[1]||(o[1]=[t("div",{class:"absolute -bottom-1 left-1/2 h-2 w-px -translate-x-1/2 bg-primary"},null,-1)]),12,ee))),128)),t("div",{class:"absolute top-0 h-full w-px bg-destructive",style:f({left:N.value+"%"})},o[2]||(o[2]=[t("div",{class:"absolute -top-1 left-1/2 h-3 w-3 -translate-x-1/2 rotate-45 bg-destructive"},null,-1)]),4)])],4)])]))}}),ie=R(te,[["__scopeId","data-v-b8785e90"]]);export{ie as default};
